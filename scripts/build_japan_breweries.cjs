/**
 * 全国地ビール醸造所 GeoJSON 生成（Node で実行）
 * node scripts/build_japan_breweries.cjs
 */
const fs = require('fs');
const path = require('path');

const BREWERIES = [
  ["b-1", "オホーツクビール", "おほーつくびーる", "北海道", "北海道北見市", 143.89, 43.80, "microbrewery"],
  ["b-2", "はこだてビール", "はこだてびーる", "北海道", "北海道函館市", 140.73, 41.77, "microbrewery"],
  ["b-3", "大雪地ビール", "たいせつじびーる", "北海道", "北海道旭川市", 142.36, 43.77, "microbrewery"],
  ["b-4", "プレミアムビール鬼伝説", "おにでんせつ", "北海道", "北海道登別市", 141.11, 42.41, "microbrewery"],
  ["b-5", "小樽麦酒", "おたるむぎびーる", "北海道", "北海道小樽市", 141.00, 43.19, "microbrewery", "小樽の赤レンガ倉庫で醸造。ドイツ式ラガーが中心で、ビアホールも人気。"],
  ["b-6", "網走ビール", "あばしりびーる", "北海道", "北海道網走市", 144.28, 44.02, "microbrewery"],
  ["b-7", "トランスブリューイング", "とらんすぶりゅーいんぐ", "北海道", "北海道札幌市", 141.35, 43.06, "brewpub"],
  ["b-8", "ノースアイランドブルワリー", "のーすあいらんど", "北海道", "北海道函館市", 140.74, 41.82, "microbrewery"],
  ["b-9", "大沼ビール", "おおぬまびーる", "北海道", "北海道七飯町", 140.68, 41.98, "microbrewery"],
  ["b-9b", "羊蹄山麓ビール", "ようていさんろくびーる", "北海道", "北海道倶知安町", 140.76, 42.90, "microbrewery"],
  ["b-9c", "ニセコビール", "にせこびーる", "北海道", "北海道ニセコ町", 140.69, 42.88, "microbrewery"],
  ["b-9d", "忽布古丹醸造", "こほこたんじょうぞう", "北海道", "北海道上富良野町", 142.47, 43.45, "microbrewery"],
  ["b-9e", "サッポロビール園", "さっぽろびーるえん", "北海道", "北海道札幌市", 141.37, 43.07, "brewpub"],
  ["b-10", "奥入瀬ビール", "おいらせびーる", "青森県", "青森県十和田市", 141.05, 40.62, "microbrewery"],
  ["b-11", "八戸麦酒", "はちのへむぎびーる", "青森県", "青森県八戸市", 141.49, 40.51, "microbrewery"],
  ["b-12", "いわて蔵ビール", "いわてくらびーる", "岩手県", "岩手県一関市", 141.13, 38.93, "microbrewery"],
  ["b-12b", "ベアレン醸造所", "べあれんじょうぞうしょ", "岩手県", "岩手県盛岡市", 141.15, 39.70, "microbrewery"],
  ["b-13", "鳴子の風", "なるこのかぜ", "宮城県", "宮城県大崎市鳴子温泉", 140.73, 38.73, "microbrewery"],
  ["b-13b", "仙台クラフト", "せんだいくらふと", "宮城県", "宮城県仙台市", 140.87, 38.27, "brewpub"],
  ["b-14", "田沢湖ビール", "たざわこびーる", "秋田県", "秋田県仙北市", 140.73, 39.70, "microbrewery"],
  ["b-15", "地ビール月山", "じびーるがっさん", "山形県", "山形県西川町", 140.12, 38.53, "microbrewery"],
  ["b-16", "みちのく福島路ビール", "みちのくふくしまじ", "福島県", "福島県福島市", 140.47, 37.75, "microbrewery"],
  ["b-17", "猪苗代地ビール", "いなわしろじびーる", "福島県", "福島県猪苗代町", 140.12, 37.55, "microbrewery"],
  ["b-20", "常陸野ネストビール", "ひたちのねすと", "茨城県", "茨城県那珂市", 140.47, 36.37, "microbrewery", "日本を代表するクラフトビール。白ビール（ヴァイツェン）が特に人気。"],
  ["b-21", "牛久シャトービール", "うしくしゃとー", "茨城県", "茨城県牛久市", 140.14, 35.97, "microbrewery", "ワイン醸造所が手がけるビール。シャトー牛久の敷地内で醸造・提供。"],
  ["b-22", "那須高原ビール", "なすこうげんびーる", "栃木県", "栃木県那須町", 140.12, 37.12, "microbrewery"],
  ["b-23", "宇都宮クラフトビール", "うつのみやくらふと", "栃木県", "栃木県宇都宮市", 139.88, 36.55, "microbrewery"],
  ["b-24", "うしとらビール", "うしとらびーる", "栃木県", "栃木県下野市", 139.88, 36.38, "microbrewery"],
  ["b-24b", "那須ビール", "なすびーる", "栃木県", "栃木県那須塩原市", 140.05, 37.12, "microbrewery"],
  ["b-25", "COEDOビール", "コエド", "埼玉県", "埼玉県三芳町", 139.52, 35.83, "microbrewery", "埼玉発のクラフトビール。ガラナや黒豆などユニークな原料を使った銘柄も。"],
  ["b-25b", "群馬県地ビール", "ぐんまけんじびーる", "群馬県", "群馬県前橋市", 139.06, 36.39, "microbrewery"],
  ["b-26", "エチゴビール", "えちごびーる", "新潟県", "新潟県新潟市", 139.04, 37.92, "microbrewery"],
  ["b-27", "スワンレイクビール", "すわんれいく", "新潟県", "新潟県阿賀野市", 139.24, 37.83, "microbrewery"],
  ["b-28", "八海山泉ビール", "はっかいさんいずみ", "新潟県", "新潟県南魚沼市", 138.90, 37.00, "microbrewery"],
  ["b-29", "胎内高原ビール", "たいないこうげん", "新潟県", "新潟県胎内市", 139.41, 38.06, "microbrewery"],
  ["b-30", "ゴールデンスランバー", "ごーるでんすらんばー", "新潟県", "新潟県南魚沼市", 138.88, 37.02, "brewpub"],
  ["b-31", "オラホビール", "おらほびーる", "長野県", "長野県東御市", 138.36, 36.35, "microbrewery"],
  ["b-32", "諏訪浪漫ビール", "すわろまんびーる", "長野県", "長野県諏訪市", 138.12, 36.04, "microbrewery"],
  ["b-33", "穂高ビール", "ほたかびーる", "長野県", "長野県安曇野市", 137.90, 36.35, "microbrewery"],
  ["b-34", "軽井沢浅間高原ビール", "かるいざわあさま", "長野県", "長野県佐久市", 138.49, 36.27, "microbrewery"],
  ["b-35", "志賀高原ビール", "しがこうげんびーる", "長野県", "長野県山ノ内町", 138.45, 36.72, "microbrewery"],
  ["b-36", "南信州ビール", "みなみしんしゅう", "長野県", "長野県駒ヶ根市", 137.93, 35.73, "microbrewery"],
  ["b-37", "松本ブルワリー", "まつもとぶるわりー", "長野県", "長野県松本市", 137.97, 36.24, "brewpub"],
  ["b-38", "ヨ・ホー Brewing", "よーほー", "長野県", "長野県上田市", 138.25, 36.40, "microbrewery"],
  ["b-38b", "北アルプスビール", "きたあるぷすびーる", "長野県", "長野県大町市", 137.85, 36.50, "microbrewery"],
  ["b-38c", "安曇野ビール", "あづみのびーる", "長野県", "長野県安曇野市", 137.88, 36.30, "microbrewery"],
  ["b-40", "九十九里オーシャンビール", "くじゅうくりおーしゃん", "千葉県", "千葉県山武市", 140.41, 35.62, "microbrewery"],
  ["b-41", "ハーヴェスト・ムーン", "はーべすとむーん", "千葉県", "千葉県浦安市", 139.89, 35.63, "brewpub"],
  ["b-42", "多摩の恵", "たまのめぐみ", "東京都", "東京都福生市", 139.33, 35.74, "microbrewery"],
  ["b-43", "ティーワイハーバーブルワリー", "てぃーわいはーばー", "東京都", "東京都品川区", 139.75, 35.61, "brewpub"],
  ["b-44", "高田馬場ビール工房", "たかだのばば", "東京都", "東京都新宿区", 139.70, 35.71, "brewpub"],
  ["b-45", "暁ブリュワリー", "あかつきぶりゅわりー", "東京都", "東京都渋谷区", 139.68, 35.66, "brewpub"],
  ["b-46", "和泉ブルワリー", "いずみぶるわりー", "東京都", "東京都狛江市", 139.58, 35.64, "brewpub"],
  ["b-47", "Far Yeast Brewing", "ふぁーいーすと", "東京都", "東京都渋谷区", 139.70, 35.66, "microbrewery"],
  ["b-48", "TOKYO ALEWORKS", "とうきょうえーるわーくす", "東京都", "東京都板橋区", 139.68, 35.75, "brewpub"],
  ["b-49", "スプリングバレー醸造", "すぷりんぐばれー", "東京都", "東京都渋谷区", 139.70, 35.66, "brewpub"],
  ["b-50", "ヤナヤナビール", "やなやな", "東京都", "東京都目黒区", 139.72, 35.64, "brewpub"],
  ["b-50b", "TAKAO BEER", "たかおびーる", "東京都", "東京都八王子市", 139.34, 35.66, "microbrewery"],
  ["b-50c", "デビルクラフト", "でびるくらふと", "東京都", "東京都港区", 139.75, 35.66, "brewpub"],
  ["b-50d", "Watering Hole", "うぉーたりんぐほーる", "東京都", "東京都渋谷区", 139.70, 35.66, "brewpub"],
  ["b-51", "箱根ビール", "はこねびーる", "神奈川県", "神奈川県小田原市", 139.16, 35.25, "microbrewery", "箱根の水を使ったピルスナーが定番。観光地でも人気。"],
  ["b-52", "さがみビール", "さがみびーる", "神奈川県", "神奈川県厚木市", 139.37, 35.44, "microbrewery", "神奈川・相模原エリアの地ビール。地元食材を活かしたビールも。"],
  ["b-53", "鎌倉ビール", "かまくらびーる", "神奈川県", "神奈川県鎌倉市", 139.55, 35.32, "microbrewery", "湘南・鎌倉の醸造所。ビーチサイドの雰囲気が人気。"],
  ["b-54", "横浜ビール", "よこはまびーる", "神奈川県", "神奈川県横浜市", 139.64, 35.45, "microbrewery", "横浜発のクラフトビール。開港の街らしい多様なスタイルを醸造。"],
  ["b-55", "湘南ビール", "しょうなんびーる", "神奈川県", "神奈川県茅ヶ崎市", 139.41, 35.33, "microbrewery"],
  ["b-56", "サンクトガーレン", "さんくとがーれん", "神奈川県", "神奈川県厚木市", 139.35, 35.46, "microbrewery"],
  ["b-57", "横浜ベイブルーイング", "よこはまべい", "神奈川県", "神奈川県横浜市", 139.53, 35.40, "microbrewery"],
  ["b-58", "ヨロッコビール", "よろっこびーる", "神奈川県", "神奈川県逗子市", 139.58, 35.30, "microbrewery"],
  ["b-59", "富士桜高原ビール", "ふじさくらこうげん", "山梨県", "山梨県富士河口湖町", 138.76, 35.50, "microbrewery"],
  ["b-60", "八ヶ岳タッチダウンビール", "やつがたけてぃだうん", "山梨県", "山梨県北杜市", 138.43, 35.95, "microbrewery"],
  ["b-60b", "UCHU BREWING", "うちゅーぶりゅーいんぐ", "山梨県", "山梨県北杜市小淵沢", 138.32, 35.86, "microbrewery"],
  ["b-62", "浜松アクトビール", "はままつあくと", "静岡県", "静岡県浜松市", 137.73, 34.71, "microbrewery"],
  ["b-63", "御殿場高原ビール", "ごてんばこうげん", "静岡県", "静岡県御殿場市", 138.94, 35.30, "microbrewery", "富士山麓・御殿場の醸造所。ピルスナーを中心に、レストランでも提供。"],
  ["b-64", "風の谷のビール", "かぜのたにのびーる", "静岡県", "静岡県函南町", 138.95, 35.10, "microbrewery", "伊豆・函南の自然を活かした地ビール。パブも併設。"],
  ["b-65", "伊豆高原ビール", "いずこうげんびーる", "静岡県", "静岡県伊東市", 139.10, 34.92, "microbrewery"],
  ["b-66", "反射炉ビヤ", "はんしゃろびあ", "静岡県", "静岡県伊豆の国市", 138.96, 35.05, "microbrewery"],
  ["b-67", "ベアードビール", "べあーど", "静岡県", "静岡県沼津市", 138.86, 35.10, "microbrewery"],
  ["b-67b", "富士メイスビア", "ふじめいすびあ", "静岡県", "静岡県富士宮市", 138.62, 35.22, "microbrewery"],
  ["b-68", "金しゃちビール", "きんしゃち", "愛知県", "愛知県犬山市", 136.95, 35.38, "microbrewery"],
  ["b-69", "名古屋醸造", "なごやじょうぞう", "愛知県", "愛知県名古屋市", 136.91, 35.18, "brewpub"],
  ["b-70", "伊勢角谷麦酒", "いせかどや", "三重県", "三重県伊勢市", 136.71, 34.49, "microbrewery", "伊勢神宮に近い老舗。地酒と地ビールの両方を醸造。"],
  ["b-71", "伊勢角屋ビール", "いせかどやびーる", "三重県", "三重県伊勢市", 136.71, 34.49, "microbrewery"],
  ["b-71b", "岐阜県地ビール", "ぎふけんじびーる", "岐阜県", "岐阜県岐阜市", 136.76, 35.42, "microbrewery"],
  ["b-73", "宇奈月ビール", "うなづきびーる", "富山県", "富山県黒部市", 137.65, 36.82, "microbrewery"],
  ["b-74", "城端麦酒", "じょうはなむぎびーる", "富山県", "富山県南砺市", 136.91, 36.56, "microbrewery"],
  ["b-75", "石川県地ビール", "いしかわけんじびーる", "石川県", "石川県金沢市", 136.63, 36.59, "microbrewery"],
  ["b-76", "福井地ビール", "ふくいじびーる", "福井県", "福井県福井市", 136.22, 36.07, "microbrewery"],
  ["b-78", "滋賀県地ビール", "しがけんじびーる", "滋賀県", "滋賀県大津市", 135.87, 35.00, "microbrewery"],
  ["b-79", "京都町家麦酒", "きょうとまちや", "京都府", "京都府京都市", 135.77, 35.01, "microbrewery", "京の町家で醸造。クラフトビールと京料理の組み合わせが人気。"],
  ["b-80", "京都麦酒", "きょうとむぎびーる", "京都府", "京都府京都市伏見区", 135.77, 34.94, "microbrewery", "伏見の酒蔵街にある醸造所。日本酒の町で育ったクラフトビール。"],
  ["b-81", "一乗寺ブリュワリー", "いちじょうじ", "京都府", "京都府京都市左京区", 135.79, 35.03, "brewpub"],
  ["b-82", "西陣麦酒", "にしじんむぎびーる", "京都府", "京都府京都市上京区", 135.75, 35.03, "microbrewery"],
  ["b-83", "ウッドミルブルワリー京都", "うっどみるきょうと", "京都府", "京都府京都市", 135.76, 35.03, "microbrewery"],
  ["b-84", "KIX BEER", "きっくすびーる", "京都府", "京都府京都市", 135.76, 35.01, "brewpub"],
  ["b-85", "丹後王国ブルワリー", "たんごおうこく", "京都府", "京都府京丹後市", 135.14, 35.63, "microbrewery"],
  ["b-86", "家守酒造", "やもりしゅぞう", "京都府", "京都府京都市伏見区", 135.77, 34.94, "microbrewery"],
  ["b-86b", "月の輪酒造", "つきのわしゅぞう", "京都府", "京都府京都市", 135.76, 35.02, "microbrewery"],
  ["b-88", "大阪國乃長ビール", "おおさかくにのちょう", "大阪府", "大阪府高槻市", 135.62, 34.85, "microbrewery"],
  ["b-89", "箕面ビール", "みのおびーる", "大阪府", "大阪府箕面市", 135.47, 34.82, "microbrewery", "箕面の名水を使った地ビール。箕面瀑布にちなんだ銘柄も。"],
  ["b-90", "ONE's BREWERY", "わんず", "大阪府", "大阪府大阪市", 135.46, 34.67, "brewpub"],
  ["b-91", "YAMATO Brewery", "やまと", "大阪府", "大阪府大阪市", 135.52, 34.69, "brewpub"],
  ["b-92", "CRAFT BEER BASE", "くらふとびーるべーす", "大阪府", "大阪府大阪市", 135.49, 34.70, "brewpub"],
  ["b-93", "道頓堀麦酒", "どうとんぼりむぎびーる", "大阪府", "大阪府大阪市", 135.50, 34.67, "brewpub"],
  ["b-94", "Derailleur Brew Works", "でらいゅーる", "大阪府", "大阪府大阪市", 135.49, 34.65, "brewpub"],
  ["b-95", "キューガモンブルワリー", "きゅーがもん", "大阪府", "大阪府堺市", 135.48, 34.57, "brewpub"],
  ["b-95b", "堺ビール", "さかいびーる", "大阪府", "大阪府堺市", 135.46, 34.57, "microbrewery"],
  ["b-96", "小西ビール", "こにしびーる", "兵庫県", "兵庫県伊丹市", 135.42, 34.78, "microbrewery"],
  ["b-97", "六甲ビール", "ろっこうびーる", "兵庫県", "兵庫県神戸市", 135.22, 34.78, "microbrewery", "六甲の水で醸造。神戸らしいスタイリッシュなクラフトビール。"],
  ["b-98", "子午線ビール", "しごせんびーる", "兵庫県", "兵庫県明石市", 134.99, 34.65, "microbrewery"],
  ["b-99", "神戸ビール", "こうべびーる", "兵庫県", "兵庫県神戸市", 135.19, 34.69, "microbrewery", "神戸発のクラフトビール。港町らしい多様なビールを展開。"],
  ["b-99b", "神戸クラフト", "こうべくらふと", "兵庫県", "兵庫県神戸市", 135.20, 34.70, "brewpub"],
  ["b-100", "曽爾高原ビール", "そにこうげん", "奈良県", "奈良県曽爾村", 136.12, 34.52, "microbrewery"],
  ["b-101", "ならビール", "ならびーる", "奈良県", "奈良県奈良市", 135.83, 34.69, "microbrewery"],
  ["b-102", "グットウルフ麦酒", "ぐっとうるふ", "奈良県", "奈良県東吉野村", 135.98, 34.42, "microbrewery"],
  ["b-103", "ナギサビール", "なぎさびーる", "和歌山県", "和歌山県白浜町", 135.38, 33.69, "microbrewery"],
  ["b-105", "大山Gビール", "だいせんじーびーる", "鳥取県", "鳥取県伯耆町", 133.39, 35.39, "microbrewery"],
  ["b-106", "タルマーリ", "たるまーりー", "鳥取県", "鳥取県智頭町", 134.23, 35.26, "microbrewery"],
  ["b-107", "AKARI BREWING", "あかり", "鳥取県", "鳥取県鳥取市", 134.24, 35.50, "microbrewery"],
  ["b-108", "JAP BREWERY", "じゃっぷ", "鳥取県", "鳥取県米子市", 133.33, 35.43, "microbrewery"],
  ["b-109", "BREW LAB KURAYOSHI", "ぶるーらぼくらよし", "鳥取県", "鳥取県倉吉市", 133.82, 35.43, "brewpub"],
  ["b-110", "松江地ビール ビアへるん", "まつえじびーる", "島根県", "島根県松江市", 133.05, 35.47, "microbrewery"],
  ["b-111", "石見麦酒", "いわみむぎびーる", "島根県", "島根県江津市", 132.22, 35.01, "microbrewery"],
  ["b-112", "独歩ビール", "どっぽびーる", "岡山県", "岡山県岡山市", 133.93, 34.66, "microbrewery"],
  ["b-113", "作州津山ビール", "さくしゅうつやま", "岡山県", "岡山県津山市", 133.99, 35.07, "microbrewery"],
  ["b-114", "真備竹林麦酒", "まびちくりん", "岡山県", "岡山県倉敷市", 133.71, 34.62, "microbrewery"],
  ["b-115", "吉備土手下麦酒", "きびどてした", "岡山県", "岡山県岡山市", 133.93, 34.66, "microbrewery"],
  ["b-116", "ヒロシマネイバリーブリューイング", "ひろしまねいばりー", "広島県", "広島県広島市", 132.46, 34.40, "brewpub"],
  ["b-117", "ヱビスビール", "えびす", "広島県", "広島県広島市", 132.46, 34.39, "regional"],
  ["b-118", "山口地ビール", "やまぐちじびーる", "山口県", "山口県山口市", 131.47, 34.19, "microbrewery"],
  ["b-120", "まめまめびーる", "まめまめびーる", "香川県", "香川県小豆島町", 134.24, 34.48, "microbrewery"],
  ["b-121", "梅錦ビール", "うめにしきびーる", "愛媛県", "愛媛県四国中央市", 133.56, 33.98, "microbrewery"],
  ["b-122", "道後ビール", "どうごびーる", "愛媛県", "愛媛県松山市", 132.79, 33.85, "microbrewery"],
  ["b-123", "TOSACO", "とさこ", "高知県", "高知県香美市", 133.70, 33.67, "microbrewery"],
  ["b-124", "徳島クラフト", "とくしまくらふと", "徳島県", "徳島県徳島市", 134.56, 34.07, "microbrewery"],
  ["b-126", "門司港レトロビール", "もじこうれとろ", "福岡県", "福岡県北九州市", 130.96, 33.95, "microbrewery"],
  ["b-127", "ホテルオークラ福岡", "おーくらふくおか", "福岡県", "福岡県福岡市", 130.40, 33.59, "brewpub"],
  ["b-128", "博多杉能舎麦酒", "はかたすぎのや", "福岡県", "福岡県福岡市", 130.35, 33.59, "microbrewery"],
  ["b-129", "プレデター醸造所", "ぷれでたー", "福岡県", "福岡県福岡市", 130.40, 33.59, "brewpub"],
  ["b-129b", "福岡クラフト", "ふくおかくらふと", "福岡県", "福岡県福岡市", 130.41, 33.59, "brewpub"],
  ["b-129c", "久留米クラフト", "くるめくらふと", "福岡県", "福岡県久留米市", 130.52, 33.32, "microbrewery"],
  ["b-130", "佐賀県地ビール", "さがけんじびーる", "佐賀県", "佐賀県佐賀市", 130.30, 33.25, "microbrewery"],
  ["b-131", "長崎クラフト", "ながさきくらふと", "長崎県", "長崎県長崎市", 129.88, 32.75, "microbrewery"],
  ["b-132", "熊本県地ビール", "くまもとけんじびーる", "熊本県", "熊本県熊本市", 130.70, 32.79, "microbrewery"],
  ["b-133", "ゆふいんビール", "ゆふいんびーる", "大分県", "大分県由布市", 131.35, 33.26, "microbrewery", "由布院の温泉街で醸造。癒しの地で楽しめる地ビール。"],
  ["b-134", "久住高原地ビール", "くじゅうこうげん", "大分県", "大分県竹田市", 131.15, 33.10, "microbrewery"],
  ["b-135", "ひでじビール", "ひでじびーる", "宮崎県", "宮崎県延岡市", 131.66, 32.58, "microbrewery"],
  ["b-136", "雲海麦酒醸造所", "うんかいむぎびーる", "宮崎県", "宮崎県綾町", 131.25, 32.02, "microbrewery"],
  ["b-137", "霧島ビール", "きりしまびーる", "宮崎県", "宮崎県都城市", 131.10, 31.72, "microbrewery"],
  ["b-138", "薩摩のビール", "さつまのびーる", "鹿児島県", "鹿児島県枕崎市", 130.30, 31.27, "microbrewery"],
  ["b-139", "鹿児島クラフト", "かごしまくらふと", "鹿児島県", "鹿児島県鹿児島市", 130.56, 31.60, "microbrewery"],
  ["b-140", "ヘリオスクラフトビール", "へりおす", "沖縄県", "沖縄県名護市", 127.98, 26.59, "regional", "沖縄・名護の醸造所。南国らしいフルーティなビールが人気。"],
  ["b-141", "石垣島ビール", "いしがきじまびーる", "沖縄県", "沖縄県石垣市", 124.16, 24.34, "microbrewery", "石垣島の水と原料を活かした島ビール。リゾートでも人気。"],
  ["b-142", "オリオン醸造", "おりおん", "沖縄県", "沖縄県那覇市", 127.68, 26.21, "regional"],
  ["b-142b", "コザクラフト", "こざくらふと", "沖縄県", "沖縄県沖縄市", 127.80, 26.33, "brewpub"],
];

// 都道府県の座標範囲（境界判定・生産地検証用）[minLat, maxLat, minLng, maxLng]
const PREFECTURE_BOUNDS = {
  '北海道': [41.3, 45.6, 139.3, 145.9],
  '青森県': [40.2, 41.6, 139.4, 141.7],
  '岩手県': [38.7, 40.5, 140.6, 142.1],
  '宮城県': [37.7, 39.0, 140.2, 141.7],
  '秋田県': [39.0, 40.5, 139.7, 140.9],
  '山形県': [37.7, 39.2, 139.5, 140.7],
  '福島県': [36.8, 37.9, 139.1, 141.1],
  '茨城県': [35.7, 36.9, 139.6, 140.9],
  '栃木県': [36.2, 37.2, 139.3, 140.3],
  '群馬県': [36.0, 37.1, 138.4, 139.7],
  '埼玉県': [35.7, 36.3, 138.7, 139.9],
  '千葉県': [34.9, 36.1, 139.7, 140.9],
  '東京都': [35.5, 35.9, 138.9, 139.9],
  '神奈川県': [35.1, 35.7, 138.9, 139.8],
  '新潟県': [36.7, 38.6, 137.8, 140.0],
  '富山県': [36.3, 36.9, 136.7, 137.8],
  '石川県': [36.1, 37.9, 136.2, 137.4],
  '福井県': [35.4, 36.3, 135.4, 136.8],
  '山梨県': [35.2, 36.05, 138.1, 139.2],
  '長野県': [35.2, 37.0, 137.3, 138.8],
  '岐阜県': [35.1, 36.5, 136.3, 137.7],
  '静岡県': [34.6, 35.6, 137.4, 139.2],
  '愛知県': [34.5, 35.4, 136.6, 137.8],
  '三重県': [33.7, 35.2, 135.8, 136.9],
  '滋賀県': [34.8, 35.7, 135.7, 136.5],
  '京都府': [34.8, 35.8, 134.8, 136.1],
  '大阪府': [34.2, 35.0, 135.1, 135.8],
  '兵庫県': [34.2, 35.7, 134.2, 135.5],
  '奈良県': [33.8, 34.8, 135.5, 136.2],
  '和歌山県': [33.4, 34.4, 135.0, 136.0],
  '鳥取県': [35.0, 35.6, 133.1, 134.5],
  '島根県': [34.3, 36.3, 131.6, 133.4],
  '岡山県': [34.3, 35.3, 133.4, 134.5],
  '広島県': [34.0, 35.1, 132.0, 133.5],
  '山口県': [33.7, 34.8, 130.8, 132.2],
  '徳島県': [33.7, 34.3, 133.5, 134.8],
  '香川県': [34.0, 34.5, 133.5, 134.5],
  '愛媛県': [32.9, 34.1, 132.0, 133.7],
  '高知県': [32.7, 33.9, 132.4, 134.3],
  '福岡県': [33.0, 34.0, 130.0, 131.2],
  '佐賀県': [32.9, 33.6, 129.7, 130.5],
  '長崎県': [32.5, 34.7, 128.6, 130.4],
  '熊本県': [32.0, 33.2, 130.1, 131.3],
  '大分県': [32.7, 33.8, 130.8, 132.1],
  '宮崎県': [31.3, 32.9, 130.6, 131.9],
  '鹿児島県': [27.0, 32.3, 128.4, 131.2],
  '沖縄県': [24.0, 27.9, 122.9, 131.3],
};

function inPrefecture(lat, lng, prefecture) {
  const b = PREFECTURE_BOUNDS[prefecture];
  if (!b) return false;
  const [minLat, maxLat, minLng, maxLng] = b;
  return lat >= minLat && lat <= maxLat && lng >= minLng && lng <= maxLng;
}

// 日本付近の妥当な範囲（緯度 24-46、経度 123-146 程度）
function inJapan(lat, lng) {
  return lat >= 24 && lat <= 46 && lng >= 122 && lng <= 146;
}

// 各醸造所: [id, name, name_reading, prefecture, address, lng, lat, type] または末尾に characteristics を追加
// 座標が都道府県と一致しない、または日本範囲外の場合は lat/lng を入れ替えて生産地に収まるようにする
const features = BREWERIES.map((row) => {
  const id = row[0], name = row[1], name_reading = row[2], prefecture = row[3], address = row[4];
  let lng = row[5], lat = row[6];
  const type = row[7], characteristics = row[8];
  const swappedLng = row[6], swappedLat = row[5];
  if (!inJapan(lat, lng) && inJapan(swappedLat, swappedLng) && inPrefecture(swappedLat, swappedLng, prefecture)) {
    lng = swappedLng;
    lat = swappedLat;
    console.warn("Fixed lat/lng swap (invalid coords):", name, prefecture, "->", [lng, lat]);
  } else if (!inPrefecture(lat, lng, prefecture)) {
    if (inPrefecture(swappedLat, swappedLng, prefecture)) {
      lng = swappedLng;
      lat = swappedLat;
      console.warn("Fixed lat/lng swap:", name, prefecture, "->", [lng, lat]);
    } else {
      console.warn("Out of prefecture:", name, prefecture, "lat=" + lat, "lng=" + lng);
    }
  }
  const props = { id, name, name_reading, prefecture, address, type, source: "jba" };
  if (characteristics) props.characteristics = characteristics;
  return { type: "Feature", geometry: { type: "Point", coordinates: [lng, lat] }, properties: props };
});

const geojson = { type: "FeatureCollection", features };
const outPath = path.join(__dirname, "..", "src", "data", "japan_breweries.json");
fs.writeFileSync(outPath, JSON.stringify(geojson, null, 2), "utf8");
console.log("Wrote", features.length, "breweries to", outPath);
